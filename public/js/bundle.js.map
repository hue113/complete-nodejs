{"version":3,"sources":["alerts.js","login.js","update.js","stripe.js","index.js"],"names":["hideAlert","el","document","querySelector","parentElement","removeChild","module","exports","showAlert","type","msg","markup","insertAdjacentHTML","window","setTimeout","require","login","email","password","axios","method","url","data","status","location","assign","response","message","logout","reload","updateSettings","toUpperCase","stripe","Stripe","bookTour","tourId","session","redirectToCheckout","sessionId","id","console","log","loginForm","addEventListener","e","preventDefault","getElementById","value","logOutBtn","userDataForm","form","FormData","append","files","userPasswordForm","textContent","passwordCurrent","passwordConfirm","bookBtn","target","dataset"],"mappings":"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","file":"bundle.js","sourceRoot":"","sourcesContent":["/* eslint-disable */\nconst hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nmodule.exports.showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","/* eslint-disable */\nconst { showAlert } = require('./alerts');\n\nmodule.exports.login = async (email, password) => {\n  // console.log('login', email, password);\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/users/login',\n      data: {\n        email,\n        password,\n      },\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Logged in successfully!');\n      // location.assign('/');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1000);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n    // console.log(err.response.data);\n  }\n};\n\nmodule.exports.logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/v1/users/logout',\n    });\n    if (res.data.status === 'success') {\n      location.reload();\n      location.assign('/login');\n    }\n  } catch (err) {\n    // console.log(err);\n    showAlert('error', 'Error logging out! Try again.');\n  }\n};\n","/* eslint-disable */\n\nconst { showAlert } = require('./alerts');\n\nmodule.exports.updateSettings = async (data, type) => {\n  try {\n    const url = type === 'password' ? '/api/v1/users/updateMyPassword' : '/api/v1/users/updateMe';\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data,\n    });\n    // console.log('res', res);\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\n    }\n  } catch (err) {\n    // console.log(err.response);\n    showAlert('error', err.response.data.message);\n  }\n};\n","/* eslint-disable */\n// import axios from 'axios';\n// const { showAlert } = require('./alerts.js');\nconst { showAlert } = require('./alerts');\n\nconst stripe = Stripe(\n  'pk.eyJ1IjoiaHVlcHQ5MiIsImEiOiJja2tzejZuMDgwY3Q4Mndxb3ZhcndvbjdyIn0.95arHl19VG6HRTnTF25L5g',\n);\n\nmodule.exports.bookTour = async (tourId) => {\n  try {\n    // 1) Get checkout session from API\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n    // console.log(session);\n\n    // 2) Create checkout form + chanre credit card\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n  } catch (err) {\n    console.log(err);\n    showAlert('error', err);\n  }\n};\n","/* eslint-disable */\n// import axios from 'axios';\nconst { login, logout } = require('./login.js');\nconst { updateSettings } = require('./update');\nconst { bookTour } = require('./stripe.js');\n// import '@babel/polyfill';\nconsole.log('Hello from index.js');\n\n//======= MAP =======\n\n//======= ALERT =======\n\n//======= LOG IN ========\nconst loginForm = document.querySelector('.form--login');\nif (loginForm)\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login(email, password);\n  });\n\n//======= LOG OUT ========\nconst logOutBtn = document.querySelector('.nav__el--logout');\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\n\n//======= UPDATE =======\nconst userDataForm = document.querySelector('.form-user-data');\nif (userDataForm) {\n  userDataForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n    console.log(form);\n    updateSettings(form, 'data');\n  });\n}\n\nconst userPasswordForm = document.querySelector('.form-user-password');\nif (userPasswordForm) {\n  userPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings({ passwordCurrent, password, passwordConfirm }, 'password');\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n}\n\n//======= STRIPE =======\n// const Stripe = require('stripe');\n// const stripe = Stripe(\n//   'pk_test_51HzlQ4FD0x4Cf1q082I8zPeNMLHJAnc0Z9omFu6GVpvNlBvMpqIizld3SBGcUKyKTpNhYRqZxNhmzY3pxEMXf5Qa00hQiaolC5',\n// );\n\n// const bookTour = async (tourId) => {\n//   console.log('inside bookTour', tourId);\n//   try {\n//     // 1) Get checkout session from API\n//     const session = await axios(`http://localhost:3000/api/v1/bookings/checkout-session/${tourId}`);\n//     console.log(session);\n\n//     // 2) Create checkout form + charge credit card\n//     await stripe.redirectToCheckout({\n//       sessionId: session.data.session.id,\n//     });\n//   } catch (err) {\n//     console.log(err);\n//     showAlert('error', err);\n//   }\n// };\n\nconst bookBtn = document.getElementById('book-tour');\nif (bookBtn)\n  bookBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n"]}